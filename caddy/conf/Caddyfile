http:///client/ {
  root /client

  header / {
    Cache-Control "public, max-age=31536000, immutable"
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    -Server
  }

  rewrite {
    r (.*)
    to {1} /proxy{path}
  }

  proxy /proxy http://app:9000 {
    without /proxy

    transparent
    websocket
  }
}

http:///static/ {
  root /webroot/storage

  rewrite / {
    if {method} is OPTIONS
    to /CORS
  }

  rewrite {
    r ^/webseed/(.*)
    to /videos/{1}
  }

  rewrite {
    r (.*)
    to {1} /proxy{path}
  }

  header / {
    Access-Control-Allow-Origin "*"
    Access-Control-Allow-Methods "GET, OPTIONS"
    Access-Control-Allow-Headers "Range,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type"
    Cache-Control "public, max-age=7200"
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    -Server
  }

  header /CORS {
    Access-Control-Allow-Origin "*"
    Access-Control-Allow-Methods "GET, OPTIONS"
    Access-Control-Allow-Headers "Range,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type"
    Access-Control-Max-Age "1728000"
    Content-Type "text/plain charset=UTF-8"
    Content-Length "0"
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    -Server
  }

  status 204 /CORS

  proxy /proxy http://app:9000 {
    without /proxy

    transparent
    websocket
  }
}

http:// {
  header / {
    Referrer-Policy "strict-origin"
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    X-XSS-Protection "1; mode=block"
    -Server
  }

  proxy / http://app:9000 {
    transparent
    websocket
  }
}
